import"../chunks/CWj6FrbW.js";import"../chunks/Bj_6Qs7F.js";import{p as oe,G as z,u as Q,I as m,W as se,g as e,f as ie,a as le,aj as o,al as A,ak as n,ai as P,o as Pe,J as X}from"../chunks/DOREUks6.js";import{s as j}from"../chunks/q6NL7zVp.js";import{i as N}from"../chunks/BFx43QG9.js";import{a as ce,P as ve,e as $,i as ee,r as ae,b as Y}from"../chunks/hXFmxJzW.js";import{c as ue,a as i,t as g,d as ne}from"../chunks/DaIljfVv.js";import{i as Ie}from"../chunks/T1mHjWKl.js";import{c as de,B as qe}from"../chunks/BTvZcNQX.js";import{d as Ee}from"../chunks/ChayrCMC.js";import{a as Be,b as Le}from"../chunks/DU5CFFKK.js";import{p as Z}from"../chunks/37rSdpLR.js";import{u as pe}from"../chunks/1wwSRHPD.js";async function Ve(){try{return[(await ce.get(`${ve}/actions`,{headers:{Authorization:`Bearer ${pe.current.token}`}})).data,null]}catch(y){return de(y.response),console.error("Error fetching actions:",y),[null,y]}}async function Je(y,O){const p=O.map(r=>{if(typeof r=="boolean")return r?"true":"false";if(typeof r=="object"&&r!==null)try{return JSON.stringify(r)}catch(b){return console.warn("Could not JSON stringify argument:",r,b),String(r)}return String(r)});try{return[(await ce.post(`${ve}/actions/invoke`,{path:y,args:p},{headers:{Authorization:`Bearer ${pe.current.token}`}})).data,null]}catch(r){return de(r.response),console.error(`Error invoking action '${y}':`,r),[null,r]}}async function je(y,O,p,r,b,E,f,h,d){var l;if(!e(O))return;m(p,!0),m(r,null),m(b,null);const _=e(E).args.map((t,c)=>{const B=f[c];return h(B,t)});try{const[t,c]=await Je(e(d),_);if(c)throw c;t&&t.error?m(b,t.error,!0):t?m(r,t.result,!0):m(b,"Received unexpected null response")}catch(t){m(b,((l=t.response)==null?void 0:l.data)||t.message||`Failed to invoke action '${e(d)}'`,!0)}finally{m(p,!1)}}var Fe=g('<p class="action-description svelte-5who87"> </p>'),Re=g('<input type="checkbox" class="checkbox arg-input svelte-5who87">'),ze=g('<input class="input input-sm arg-input svelte-5who87">'),Ce=g('<label class="arg-label svelte-5who87"><span class="arg-type svelte-5who87"> </span> <!></label>'),De=g('<div class="args-container svelte-5who87"></div>'),Ue=g('<p class="no-args-message svelte-5who87">(No arguments)</p>'),Ge=g('<div class="output-box error-display svelte-5who87"><pre class="svelte-5who87"> </pre></div>'),Me=g('<div class="output-box result-box svelte-5who87"><pre class="svelte-5who87"> </pre></div>'),Te=g('<div class="action-node svelte-5who87"><div class="action-header svelte-5who87"><div class="action-icon svelte-5who87">â™¦</div> <span class="action-name svelte-5who87"> </span></div> <!> <div class="action-body svelte-5who87"><div class="input-row svelte-5who87"><!> <button class="btn btn-sm invoke-button variant-ghost-primary svelte-5who87"><!></button></div> <!> <!></div></div>'),We=g('<details class="directory-node svelte-5who87" open><summary class="directory-summary list-item svelte-5who87"><span class="directory-icon svelte-5who87"></span> <span class="directory-name svelte-5who87"> </span></summary> <div class="directory-content svelte-5who87"></div></details>');function fe(y,O){oe(O,!0);let p=Z(O,"name",3,""),r=Z(O,"node",19,()=>({})),b=Z(O,"currentPath",3,""),E=z(null),f=z(null),h=z(!1),d=z(!1);Q(()=>{m(d,r()&&r()._isAction===!0,!0)});let _=z(se({args:[],description:""}));Q(()=>{m(_,e(d)?r().details:{args:[],description:""},!0)});let l=z("");Q(()=>{m(l,b()?`${b()}/${p()}`:p(),!0)});let t=se({});function c(v){switch(v){case"int":case"int8":case"int16":case"int32":case"int64":case"uint":case"uint8":case"uint16":case"uint32":case"uint64":case"float32":case"float64":return"number";case"bool":return"checkbox";case"string":default:return"text"}}function B(v,k){switch(k){case"int":case"int8":case"int16":case"int32":case"int64":case"uint":case"uint8":case"uint16":case"uint32":case"uint64":const u=parseInt(v,10);return isNaN(u)?0:u;case"float32":case"float64":const w=parseFloat(v);return isNaN(w)?0:w;case"bool":return!!v;case"string":default:return String(v)}}var G=ue(),T=ie(G);{var I=v=>{var k=Te(),u=o(k),w=A(o(u),2),C=o(w,!0);n(w),n(u);var V=A(u,2);{var F=s=>{var a=Fe(),S=o(a,!0);n(a),P(()=>j(S,e(_).description)),i(s,a)};N(V,s=>{e(_).description&&s(F)})}var D=A(V,2),W=o(D),te=o(W);{var he=s=>{var a=De();$(a,21,()=>e(_).args,ee,(S,q,J)=>{var H=Ce(),K=o(H),ke=o(K,!0);n(K);var Ae=A(K,2);{var Oe=R=>{var x=Re();ae(x),P(()=>x.disabled=e(h)),Be(x,()=>t[J],U=>t[J]=U),i(R,x)},Ne=R=>{var x=ze();ae(x),Y(x,"placeholder",`Arg ${J+1}`),P((U,Se)=>{Y(x,"type",U),x.disabled=e(h),Y(x,"step",Se)},[()=>c(e(q)),()=>c(e(q))==="number"?"any":void 0]),Le(x,()=>t[J],U=>t[J]=U),i(R,x)};N(Ae,R=>{c(e(q))==="checkbox"?R(Oe):R(Ne,!1)})}n(H),P(()=>j(ke,e(q))),i(S,H)}),n(a),i(s,a)},_e=s=>{var a=Ue();i(s,a)};N(te,s=>{e(_).args&&e(_).args.length>0?s(he):s(_e,!1)})}var M=A(te,2);M.__click=[je,d,h,E,f,_,t,B,l];var me=o(M);{var ge=s=>{var a=ne("...");i(s,a)},be=s=>{var a=ne("Invoke");i(s,a)};N(me,s=>{e(h)?s(ge):s(be,!1)})}n(M),n(W);var re=A(W,2);{var we=s=>{var a=Ge(),S=o(a),q=o(S,!0);n(S),n(a),P(()=>j(q,e(f))),i(s,a)};N(re,s=>{e(f)&&s(we)})}var ye=A(re,2);{var xe=s=>{var a=Me(),S=o(a),q=o(S,!0);n(S),n(a),P(J=>j(q,J),[()=>JSON.stringify(e(E),null,2)]),i(s,a)};N(ye,s=>{e(E)!==null&&s(xe)})}n(D),n(k),P(()=>{j(C,p()),M.disabled=e(h)}),i(v,k)},L=v=>{var k=We(),u=o(k),w=A(o(u),2),C=o(w,!0);n(w),n(u);var V=A(u,2);$(V,21,()=>r().childrenOrder,ee,(F,D)=>{fe(F,{get name(){return e(D)},get node(){return r().children[e(D)]},get currentPath(){return e(l)}})}),n(V),n(k),P(()=>j(C,p())),i(v,k)};N(T,v=>{e(d)?v(I):v(L,!1)})}i(y,G),le()}Ee(["click"]);var He=g('<div class="status-message svelte-1fqsu78">Loading...</div>'),Ke=g('<div class="status-message error svelte-1fqsu78"><strong class="svelte-1fqsu78">Error:</strong> </div>'),Qe=g('<div class="status-message svelte-1fqsu78">No actions defined.</div>'),Xe=g('<div class="actions-page svelte-1fqsu78"><h1 class="page-title svelte-1fqsu78">Remote Actions</h1> <!></div>');function vt(y,O){oe(O,!1);let p=X({}),r=X(!0),b=X(null);Pe(async()=>{try{const[f,h]=await Ve();if(h)throw h;m(p,f?E(f):{})}catch(f){m(b,f.message||"Failed to load actions")}finally{m(r,!1)}});function E(f){const h={children:{},childrenOrder:[]};return f.forEach(d=>{const _=d.path.split("/");let l=h;_.forEach((t,c)=>{c===_.length-1?(l.children[t]={_isAction:!0,details:{args:d.args,description:d.description}},l.childrenOrder.includes(t)||l.childrenOrder.push(t)):(l.children[t]||(l.children[t]={children:{},childrenOrder:[]},l.childrenOrder.push(t)),l=l.children[t])})}),h}Ie(),qe(y,{children:(f,h)=>{var d=Xe(),_=A(o(d),2);{var l=c=>{var B=He();i(c,B)},t=(c,B)=>{{var G=I=>{var L=Ke(),v=A(o(L));n(L),P(()=>j(v,` ${e(b)??""}`)),i(I,L)},T=(I,L)=>{{var v=u=>{var w=Qe();i(u,w)},k=u=>{var w=ue(),C=ie(w);$(C,1,()=>e(p).childrenOrder,ee,(V,F)=>{fe(V,{get name(){return e(F)},get node(){return e(p).children[e(F)]},currentPath:""})}),i(u,w)};N(I,u=>{Object.keys(e(p).children||{}).length===0?u(v):u(k,!1)},L)}};N(c,I=>{e(b)?I(G):I(T,!1)},B)}};N(_,c=>{e(r)?c(l):c(t,!1)})}n(d),i(f,d)},$$slots:{default:!0}}),le()}export{vt as component};
